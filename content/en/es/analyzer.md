---
date: 2022-09-18
description: "Elasticsearch åˆ†è¯ å­¦ä¹ "
image: "images/es.png"
title: "åˆ†è¯ å­¦ä¹ "
author: è¯¸è‘›é’
authorEmoji: ðŸ˜ƒ
pinned: false
tags:
- elasticsearch
series:
- 
---

## ç®€å•äº†è§£
* Analysisï¼ˆæ–‡æœ¬åˆ†æžï¼‰æ˜¯å°† å…¨æ–‡æœ¬ è½¬æ¢ç¨‹ä¸€ç³»åˆ—å•è¯çš„è¿‡ç¨‹ï¼Œä¹Ÿå«åšåˆ†è¯
* Analysisï¼ˆåˆ†è¯ï¼‰éœ€è¦é€šè¿‡ Analyzerï¼ˆåˆ†è¯å™¨ï¼‰æ¥å®žçŽ°
    * å¯ä»¥ä½¿ç”¨Elasticsearchå†…ç½®çš„åˆ†è¯å™¨ï¼Œä¹Ÿå¯ä»¥å®šåˆ¶åˆ†è¯å™¨
* åˆ†è¯å™¨ä¸»è¦ç”±ä¸‰éƒ¨åˆ†ç»„æˆ
    * Character Filters é’ˆå¯¹åŽŸå§‹æ–‡æœ¬è¿›è¡Œå¤„ç†ï¼Œæ¯”å¦‚åŽ»é™¤HTML
    * Tokenize æŒ‰ç…§ä¸€å®šè§„åˆ™ åˆ‡åˆ†ä¸ºå•è¯
    * Token Filter å°†åˆ‡åˆ†çš„å•è¯è¿›è¡ŒåŠ å·¥ï¼Œå°å†™ï¼Œåˆ é™¤ stopwordsï¼Œå¢žåŠ åŒä¹‰è¯ç­‰ç­‰
* ESå†…ç½®çš„åˆ†è¯å™¨
    * Standard Analyzerï¼šé»˜è®¤çš„åˆ†è¯å™¨ï¼ŒæŒ‰è¯åˆ‡åˆ†ï¼Œå°å†™å¤„ç†
    * Simple Analyzerï¼šæŒ‰ç…§éžå­—æ¯åˆ‡åˆ†ï¼Œéžå­—æ¯éƒ½ä¼šè¢«åŽ»é™¤ï¼Œå°å†™å¤„ç†
    * WhiteSpace Analyzerï¼šæŒ‰ç…§ç©ºæ ¼åˆ‡åˆ†
    * Keyword Analyzerï¼šä¸è¿›è¡Œåˆ†è¯
    * pattern Analyzerï¼šæŒ‰ç…§æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œåˆ†è¯

## ä¸­æ–‡åˆ†è¯
> é€‰åž‹ï¼Œä½¿ç”¨Ikåˆ†è¯å™¨ï¼Œåœ°å€ï¼šhttps://github.com/medcl/elasticsearch-analysis-ik

### IK ä¸­ analyzer ik_max_word å’Œ ik_smart ä»€ä¹ˆåŒºåˆ«

* ik_max_word: ä¼šå°†æ–‡æœ¬åšæœ€ç»†ç²’åº¦çš„æ‹†åˆ†ï¼Œæ¯”å¦‚ä¼šå°†â€œä¸­åŽäººæ°‘å…±å’Œå›½å›½æ­Œâ€æ‹†åˆ†ä¸ºâ€œä¸­åŽäººæ°‘å…±å’Œå›½,ä¸­åŽäººæ°‘,ä¸­åŽ,åŽäºº,äººæ°‘å…±å’Œå›½,äººæ°‘,äºº,æ°‘,å…±å’Œå›½,å…±å’Œ,å’Œ,å›½å›½,å›½æ­Œâ€ï¼Œä¼šç©·å°½å„ç§å¯èƒ½çš„ç»„åˆï¼Œé€‚åˆ Term Query

* ik_smart: ä¼šåšæœ€ç²—ç²’åº¦çš„æ‹†åˆ†ï¼Œæ¯”å¦‚ä¼šå°†â€œä¸­åŽäººæ°‘å…±å’Œå›½å›½æ­Œâ€æ‹†åˆ†ä¸ºâ€œä¸­åŽäººæ°‘å…±å’Œå›½,å›½æ­Œâ€ï¼Œé€‚åˆ Phrase Query

### åˆ›å»ºè‡ªå·±çš„IKè¯åº“

* è¿›å…¥åˆ°/usr/share/elasticsearch/plugins/ik/configç›®å½•ä¸‹ï¼ˆå®‰è£…çš„IKç›®å½•ä¸‹çš„configï¼‰

* åˆ›å»ºä¸€ä¸ªæ”¾è‡ªå®šä¹‰å­—å…¸çš„ç›®å½•`mkdir my_dict`

* åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å­˜æ”¾è‡ªå®šä¹‰çš„wordï¼Œ`vi word.dic`ï¼Œå†™å…¥ä¸€äº›wordï¼Œæ¯”å¦‚ï¼šå•†å“çš„å…¨åï¼ŒåŠ¨æ¼«åï¼Œæ€»ä¹‹æ˜¯ä¸€äº›ä½ èƒ½è¯†åˆ«ï¼Œä½†åˆ†è¯å™¨éš¾ä»¥è¯†åˆ«çš„è¯
* åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å­˜æ”¾è‡ªå®šä¹‰çš„stop_wordï¼Œ`vi stop_word.dic`ï¼Œå†™å…¥ä¸€äº›stop_wordï¼Œæ¯”å¦‚ï¼šçš„ï¼Œåœ°ï¼Œæ˜¯ï¼Œå‘¦
* `vi /usr/share/elasticsearch/plugins/ik/config/IKAnalyzer.cfg.xml` å°†è‡ªå®šä¹‰è¯å…¸è·¯å¾„æ·»åŠ è¿›åŽ»
* é‡å¯å®¹å™¨ï¼Œæµ‹è¯•ï¼Œåˆ†è¯æ˜¯å¦åŒ…å«è¯åº“å®šä¹‰çš„è¯



## tips

### dockerçŽ¯å¢ƒä¸‹çš„elasticsearchå®¹å™¨ä¸­æ–‡å‡ºçŽ°ä¹±ç 
* æ·»åŠ ä¸­æ–‡çŽ¯å¢ƒ
```shell
yum install kde-l10n-Chinese -y
yum install glibc-common -y
localedef -c -f UTF-8 -i zh_CN zh_CN.utf8
echo "export LC_ALL=zh_CN.utf8" >> /etc/profile
source /etc/profile
```